!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):e(t.$)}(this,function(t){"use strict";function e(t){return t&&t.__esModule?t.default:t}function n(t,e){return e={exports:{}},t(e,e.exports),e.exports}function i(t,e){var n=t.data&&t.data[e];return n&&new RegExp("^"+Ze.escapeRegExChars(n)+"(["+Je+"]|$)","i").test(t.value)}function o(t,e){return rn.test(e)&&!rn.test(t)?e:t}function r(t,e,n,i,r){var s=this;return o(s.highlightMatches(t,n,i,r),s.highlightMatches(e,n,i,r))}function s(e,n){var i=this;i.element=e,i.el=t(e),i.suggestions=[],i.badQueries=[],i.selectedIndex=-1,i.currentValue=i.element.value,i.intervalId=0,i.cachedResponse={},i.enrichmentCache={},i.currentRequest=null,i.inputPhase=null,i.inputPhaseResolve=function(){},i.inputPhaseReject=function(){},i.fetchPhase=t.Deferred(),i.enrichPhase=t.Deferred(),i.onChangeTimeout=null,i.triggering={},i.$wrapper=null,i.options=t.extend({},en,n),i.classes={hint:"suggestions-hint",mobile:"suggestions-mobile",nowrap:"suggestions-nowrap",selected:"suggestions-selected",suggestion:"suggestions-suggestion",subtext:"suggestions-subtext",subtext_inline:"suggestions-subtext suggestions-subtext_inline",subtext_delimiter:"suggestions-subtext-delimiter",subtext_label:"suggestions-subtext suggestions-subtext_label",removeConstraint:"suggestions-remove",value:"suggestions-value"},i.disabled=!1,i.selection=null,i.$viewport=t(window),i.$body=t(document.body),i.type=null,i.status={},i.setupElement(),i.initializer=t.Deferred(),i.el.is(":visible")?i.initializer.resolve():i.deferInitialization(),i.initializer.done(t.proxy(i.initialize,i))}function a(){Ze.each(ji,function(t){t.xhr.abort()}),ji={}}function u(){Ti=null,en.geoLocation=Li}function c(e){return t.map(e,function(t){var e=Ze.escapeHtml(t.text);return e&&t.matched&&(e="<strong>"+e+"</strong>"),e}).join("")}function l(e,n){var i=e.split(", ");return 1===i.length?e:t.map(i,function(t){return'<span class="'+n+'">'+t+"</span>"}).join(", ")}function d(e,n){var i=!1;return t.each(e,function(t,e){if(i=e.value==n.value&&e!=n)return!1}),i}function f(e,n){var i=n.selection,o=i&&i.data&&n.bounds;return o&&t.each(n.bounds.all,function(t,n){return o=i.data[n]===e.data[n]}),o}t=t&&"default"in t?t.default:t;var p=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},h=function(t){return Object(p(t))},g={}.hasOwnProperty,v=function(t,e){return g.call(t,e)},y={}.toString,m=function(t){return y.call(t).slice(8,-1)},b=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==m(t)?t.split(""):Object(t)},_=function(t){return b(p(t))},w=Math.ceil,x=Math.floor,S=function(t){return isNaN(t=+t)?0:(t>0?x:w)(t)},C=Math.min,E=function(t){return t>0?C(S(t),9007199254740991):0},P=Math.max,k=Math.min,j=function(t,e){return t=S(t),t<0?P(t+e,0):k(t,e)},O=n(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),T=O["__core-js_shared__"]||(O["__core-js_shared__"]={}),L=function(t){return T[t]||(T[t]={})},R=0,I=Math.random(),V=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++R+I).toString(36))},B=L("keys"),F=function(t){return B[t]||(B[t]=V(t))},D=function(t){return function(e,n,i){var o,r=_(e),s=E(r.length),a=j(i,s);if(t&&n!=n){for(;s>a;)if((o=r[a++])!=o)return!0}else for(;s>a;a++)if((t||a in r)&&r[a]===n)return t||a||0;return!t&&-1}}(!1),M=F("IE_PROTO"),A=function(t,e){var n,i=_(t),o=0,r=[];for(n in i)n!=M&&v(i,n)&&r.push(n);for(;e.length>o;)v(i,n=e[o++])&&(~D(r,n)||r.push(n));return r},$="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),q=Object.keys||function(t){return A(t,$)},N=n(function(t){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)}),W=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},z=function(t,e,n){if(W(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)}}return function(){return t.apply(e,arguments)}},U=function(t){return"object"==typeof t?null!==t:"function"==typeof t},H=function(t){if(!U(t))throw TypeError(t+" is not an object!");return t},K=function(t){try{return!!t()}catch(t){return!0}},Q=!K(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),G=O.document,J=U(G)&&U(G.createElement),X=function(t){return J?G.createElement(t):{}},Y=!Q&&!K(function(){return 7!=Object.defineProperty(X("div"),"a",{get:function(){return 7}}).a}),Z=function(t,e){if(!U(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!U(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!U(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!U(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")},tt=Object.defineProperty,et=Q?Object.defineProperty:function(t,e,n){if(H(t),e=Z(e,!0),H(n),Y)try{return tt(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t},nt={f:et},it=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ot=Q?function(t,e,n){return nt.f(t,e,it(1,n))}:function(t,e,n){return t[e]=n,t},rt=function(t,e,n){var i,o,r,s=t&rt.F,a=t&rt.G,u=t&rt.S,c=t&rt.P,l=t&rt.B,d=t&rt.W,f=a?N:N[e]||(N[e]={}),p=f.prototype,h=a?O:u?O[e]:(O[e]||{}).prototype;a&&(n=e);for(i in n)(o=!s&&h&&void 0!==h[i])&&i in f||(r=o?h[i]:n[i],f[i]=a&&"function"!=typeof h[i]?n[i]:l&&o?z(r,O):d&&h[i]==r?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(r):c&&"function"==typeof r?z(Function.call,r):r,c&&((f.virtual||(f.virtual={}))[i]=r,t&rt.R&&p&&!p[i]&&ot(p,i,r)))};rt.F=1,rt.G=2,rt.S=4,rt.P=8,rt.B=16,rt.W=32,rt.U=64,rt.R=128;var st=rt;!function(t,e){var n=(N.Object||{})[t]||Object[t],i={};i[t]=e(n),st(st.S+st.F*K(function(){n(1)}),"Object",i)}("keys",function(){return function(t){return q(h(t))}});var at=N.Object.keys,ut=n(function(t){t.exports={default:at,__esModule:!0}}),ct=e(ut),lt=ot,dt={},ft=Q?Object.defineProperties:function(t,e){H(t);for(var n,i=q(e),o=i.length,r=0;o>r;)nt.f(t,n=i[r++],e[n]);return t},pt=O.document&&document.documentElement,ht=F("IE_PROTO"),gt=function(){},vt=function(){var t,e=X("iframe"),n=$.length;for(e.style.display="none",pt.appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),vt=t.F;n--;)delete vt.prototype[$[n]];return vt()},yt=Object.create||function(t,e){var n;return null!==t?(gt.prototype=H(t),n=new gt,gt.prototype=null,n[ht]=t):n=vt(),void 0===e?n:ft(n,e)},mt=n(function(t){var e=L("wks"),n=O.Symbol,i="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=i&&n[t]||(i?n:V)("Symbol."+t))}).store=e}),bt=nt.f,_t=mt("toStringTag"),wt=function(t,e,n){t&&!v(t=n?t:t.prototype,_t)&&bt(t,_t,{configurable:!0,value:e})},xt={};ot(xt,mt("iterator"),function(){return this});var St=function(t,e,n){t.prototype=yt(xt,{next:it(1,n)}),wt(t,e+" Iterator")},Ct=F("IE_PROTO"),Et=Object.prototype,Pt=Object.getPrototypeOf||function(t){return t=h(t),v(t,Ct)?t[Ct]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Et:null},kt=mt("iterator"),jt=!([].keys&&"next"in[].keys()),Ot=function(){return this},Tt=function(t,e,n,i,o,r,s){St(n,e,i);var a,u,c,l=function(t){if(!jt&&t in h)return h[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},d=e+" Iterator",f="values"==o,p=!1,h=t.prototype,g=h[kt]||h["@@iterator"]||o&&h[o],v=g||l(o),y=o?f?l("entries"):v:void 0,m="Array"==e?h.entries||g:g;if(m&&(c=Pt(m.call(new t)))!==Object.prototype&&wt(c,d,!0),f&&g&&"values"!==g.name&&(p=!0,v=function(){return g.call(this)}),s&&(jt||p||!h[kt])&&ot(h,kt,v),dt[e]=v,dt[d]=Ot,o)if(a={values:f?v:l("values"),keys:r?v:l("keys"),entries:y},s)for(u in a)u in h||lt(h,u,a[u]);else st(st.P+st.F*(jt||p),e,a);return a},Lt=function(t){return function(e,n){var i,o,r=String(p(e)),s=S(n),a=r.length;return s<0||s>=a?t?"":void 0:(i=r.charCodeAt(s),i<55296||i>56319||s+1===a||(o=r.charCodeAt(s+1))<56320||o>57343?t?r.charAt(s):i:t?r.slice(s,s+2):o-56320+(i-55296<<10)+65536)}}(!0);Tt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=Lt(e,n),this._i+=t.length,{value:t,done:!1})});var Rt=function(t,e){return{value:e,done:!!t}};Tt(Array,"Array",function(t,e){this._t=_(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,Rt(1)):"keys"==e?Rt(0,n):"values"==e?Rt(0,t[n]):Rt(0,[n,t[n]])},"values");dt.Arguments=dt.Array;for(var It=mt("toStringTag"),Vt=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],Bt=0;Bt<5;Bt++){var Ft=Vt[Bt],Dt=O[Ft],Mt=Dt&&Dt.prototype;Mt&&!Mt[It]&&ot(Mt,It,Ft),dt[Ft]=dt.Array}var At=mt,$t={f:At},qt=$t.f("iterator"),Nt=n(function(t){t.exports={default:qt,__esModule:!0}}),Wt=n(function(t){var e=V("meta"),n=nt.f,i=0,o=Object.isExtensible||function(){return!0},r=!K(function(){return o(Object.preventExtensions({}))}),s=function(t){n(t,e,{value:{i:"O"+ ++i,w:{}}})},a=function(t,n){if(!U(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!v(t,e)){if(!o(t))return"F";if(!n)return"E";s(t)}return t[e].i},u=function(t,n){if(!v(t,e)){if(!o(t))return!0;if(!n)return!1;s(t)}return t[e].w},c=function(t){return r&&l.NEED&&o(t)&&!v(t,e)&&s(t),t},l=t.exports={KEY:e,NEED:!1,fastKey:a,getWeak:u,onFreeze:c}}),zt=nt.f,Ut=function(t){var e=N.Symbol||(N.Symbol={});"_"==t.charAt(0)||t in e||zt(e,t,{value:$t.f(t)})},Ht=function(t,e){for(var n,i=_(t),o=q(i),r=o.length,s=0;r>s;)if(i[n=o[s++]]===e)return n},Kt=Object.getOwnPropertySymbols,Qt={f:Kt},Gt={}.propertyIsEnumerable,Jt={f:Gt},Xt=function(t){var e=q(t),n=Qt.f;if(n)for(var i,o=n(t),r=Jt.f,s=0;o.length>s;)r.call(t,i=o[s++])&&e.push(i);return e},Yt=Array.isArray||function(t){return"Array"==m(t)},Zt=$.concat("length","prototype"),te=Object.getOwnPropertyNames||function(t){return A(t,Zt)},ee={f:te},ne=ee.f,ie={}.toString,oe="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],re=function(t){try{return ne(t)}catch(t){return oe.slice()}},se=function(t){return oe&&"[object Window]"==ie.call(t)?re(t):ne(_(t))},ae={f:se},ue=Object.getOwnPropertyDescriptor,ce=Q?ue:function(t,e){if(t=_(t),e=Z(e,!0),Y)try{return ue(t,e)}catch(t){}if(v(t,e))return it(!Jt.f.call(t,e),t[e])},le={f:ce},de=Wt.KEY,fe=le.f,pe=nt.f,he=ae.f,ge=O.Symbol,ve=O.JSON,ye=ve&&ve.stringify,me=mt("_hidden"),be=mt("toPrimitive"),_e={}.propertyIsEnumerable,we=L("symbol-registry"),xe=L("symbols"),Se=L("op-symbols"),Ce=Object.prototype,Ee="function"==typeof ge,Pe=O.QObject,ke=!Pe||!Pe.prototype||!Pe.prototype.findChild,je=Q&&K(function(){return 7!=yt(pe({},"a",{get:function(){return pe(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=fe(Ce,e);i&&delete Ce[e],pe(t,e,n),i&&t!==Ce&&pe(Ce,e,i)}:pe,Oe=function(t){var e=xe[t]=yt(ge.prototype);return e._k=t,e},Te=Ee&&"symbol"==typeof ge.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof ge},Le=function(t,e,n){return t===Ce&&Le(Se,e,n),H(t),e=Z(e,!0),H(n),v(xe,e)?(n.enumerable?(v(t,me)&&t[me][e]&&(t[me][e]=!1),n=yt(n,{enumerable:it(0,!1)})):(v(t,me)||pe(t,me,it(1,{})),t[me][e]=!0),je(t,e,n)):pe(t,e,n)},Re=function(t,e){H(t);for(var n,i=Xt(e=_(e)),o=0,r=i.length;r>o;)Le(t,n=i[o++],e[n]);return t},Ie=function(t,e){return void 0===e?yt(t):Re(yt(t),e)},Ve=function(t){var e=_e.call(this,t=Z(t,!0));return!(this===Ce&&v(xe,t)&&!v(Se,t))&&(!(e||!v(this,t)||!v(xe,t)||v(this,me)&&this[me][t])||e)},Be=function(t,e){if(t=_(t),e=Z(e,!0),t!==Ce||!v(xe,e)||v(Se,e)){var n=fe(t,e);return!n||!v(xe,e)||v(t,me)&&t[me][e]||(n.enumerable=!0),n}},Fe=function(t){for(var e,n=he(_(t)),i=[],o=0;n.length>o;)v(xe,e=n[o++])||e==me||e==de||i.push(e);return i},De=function(t){for(var e,n=t===Ce,i=he(n?Se:_(t)),o=[],r=0;i.length>r;)!v(xe,e=i[r++])||n&&!v(Ce,e)||o.push(xe[e]);return o};Ee||(ge=function(){if(this instanceof ge)throw TypeError("Symbol is not a constructor!");var t=V(arguments.length>0?arguments[0]:void 0),e=function(n){this===Ce&&e.call(Se,n),v(this,me)&&v(this[me],t)&&(this[me][t]=!1),je(this,t,it(1,n))};return Q&&ke&&je(Ce,t,{configurable:!0,set:e}),Oe(t)},lt(ge.prototype,"toString",function(){return this._k}),le.f=Be,nt.f=Le,ee.f=ae.f=Fe,Jt.f=Ve,Qt.f=De,$t.f=function(t){return Oe(mt(t))}),st(st.G+st.W+st.F*!Ee,{Symbol:ge});for(var Me="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Ae=0;Me.length>Ae;)mt(Me[Ae++]);for(var Me=q(mt.store),Ae=0;Me.length>Ae;)Ut(Me[Ae++]);st(st.S+st.F*!Ee,"Symbol",{for:function(t){return v(we,t+="")?we[t]:we[t]=ge(t)},keyFor:function(t){if(Te(t))return Ht(we,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){ke=!0},useSimple:function(){ke=!1}}),st(st.S+st.F*!Ee,"Object",{create:Ie,defineProperty:Le,defineProperties:Re,getOwnPropertyDescriptor:Be,getOwnPropertyNames:Fe,getOwnPropertySymbols:De}),ve&&st(st.S+st.F*(!Ee||K(function(){var t=ge();return"[null]"!=ye([t])||"{}"!=ye({a:t})||"{}"!=ye(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!Te(t)){for(var e,n,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);return e=i[1],"function"==typeof e&&(n=e),!n&&Yt(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!Te(e))return e}),i[1]=e,ye.apply(ve,i)}}}),ge.prototype[be]||ot(ge.prototype,be,ge.prototype.valueOf),wt(ge,"Symbol"),wt(Math,"Math",!0),wt(O.JSON,"JSON",!0),Ut("asyncIterator"),Ut("observable");var $e=N.Symbol,qe=n(function(t){t.exports={default:$e,__esModule:!0}}),Ne=n(function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(Nt),o=n(qe),r="function"==typeof o.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof o.default&&t.constructor===o.default&&t!==o.default.prototype?"symbol":typeof t};e.default="function"==typeof o.default&&"symbol"===r(i.default)?function(t){return void 0===t?"undefined":r(t)}:function(t){return t&&"function"==typeof o.default&&t.constructor===o.default&&t!==o.default.prototype?"symbol":void 0===t?"undefined":r(t)}}),We=e(Ne),ze=N.JSON||(N.JSON={stringify:JSON.stringify}),Ue=function(t){return ze.stringify.apply(ze,arguments)},He=n(function(t){t.exports={default:Ue,__esModule:!0}}),Ke=e(He),Qe={ENTER:"Enter",ESC:"Escape",TAB:"Tab",SPACE:"Space",UP:"ArrowUp",DOWN:"ArrowDown"},Ge=".suggestions",Je="\\s\"'~\\*\\.,:\\|\\[\\]\\(\\)\\{\\}<>№",Xe=new RegExp("["+Je+"]+","g"),Ye=new RegExp("[\\-\\+\\/\\\\\\?!@#$%^&]+","g"),Ze=function(){var e=0;return{escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},escapeHtml:function(e){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return e&&t.each(n,function(t,n){e=e.replace(new RegExp(t,"g"),n)}),e},getDefaultType:function(){return t.support.cors?"POST":"GET"},getDefaultContentType:function(){return t.support.cors?"application/json":"application/x-www-form-urlencoded"},fixURLProtocol:function(e){return t.support.cors?e:e.replace(/^https?:/,location.protocol)},addUrlParams:function(e,n){return e+(/\?/.test(e)?"&":"?")+t.param(n)},serialize:function(e){return t.support.cors?Ke(e,function(t,e){return null===e?void 0:e}):(e=this.compactObject(e),t.param(e,!0))},compact:function(e){return t.grep(e,function(t){return!!t})},delay:function(t,e){return setTimeout(t,e||0)},uniqueId:function(t){return(t||"")+ ++e},slice:function(t,e){return Array.prototype.slice.call(t,e)},indexBy:function(e,n,i){var o={};return t.each(e,function(e,r){var s=r[n],a={};i&&(a[i]=e),o[s]=t.extend(!0,a,r)}),o},areSame:function e(n,i){var o=!0;return(void 0===n?"undefined":We(n))==(void 0===i?"undefined":We(i))&&("object"==(void 0===n?"undefined":We(n))&&null!=n&&null!=i?(t.each(n,function(t,n){return o=e(n,i[t])}),o):n===i)},arrayMinus:function(e,n){return n?t.grep(e,function(e,i){return-1===t.inArray(e,n)}):e},arrayMinusWithPartialMatching:function(e,n){return n?t.grep(e,function(t,e){return!n.some(function(e){return 0===e.indexOf(t)})}):e},arraysIntersection:function(e,n){var i=[];return t.isArray(e)&&t.isArray(n)?(t.each(e,function(e,o){t.inArray(o,n)>=0&&i.push(o)}),i):i},getWords:function(t,e){t=t.replace(/(\d+)([а-яА-ЯёЁ]{2,})/g,"$1 $2").replace(/([а-яА-ЯёЁ]+)(\d+)/g,"$1 $2");var n=this.compact(t.split(Xe)),i=n.pop(),o=this.arrayMinus(n,e);return o.push(i),o},normalize:function(t,e){return this.getWords(t,e).join(" ")},stringEncloses:function(t,e){return t.length>e.length&&-1!==t.indexOf(e)},fieldsNotEmpty:function(e,n){if(!t.isPlainObject(e))return!1;var i=!0;return t.each(n,function(t,n){return i=!!e[n]}),i},getDeepValue:function t(e,n){var i=n.split("."),o=i.shift();return e&&(i.length?t(e[o],i.join(".")):e[o])},reWordExtractor:function(){return new RegExp("([^"+Je+"]*)(["+Je+"]*)","g")},getTokens:function(t,e){var n,i;return n=this.compact(this.formatToken(t).split(Xe)),i=this.arrayMinus(n,e),n=this.withSubTokens(i.concat(this.arrayMinus(n,i)))},formatToken:function(t){return t&&t.toLowerCase().replace(/[ёЁ]/g,"е")},withSubTokens:function(e){var n=[];return t.each(e,function(t,e){var i=e.split(Ye);n.push(e),i.length>1&&(n=n.concat(Ze.compact(i)))}),n},objectKeys:function(e){if(ct)return ct(e);var n=[];return t.each(e,function(t){n.push(t)}),n},compactObject:function(e){var n=t.extend(!0,{},e);return t.each(n,function(t,e){null!==e&&void 0!==e&&""!==e||delete n[t]}),n},each:function(t,e){ct(t).forEach(function(n){var i=t[n];e(i,n)})},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),tn=function(){function e(e){return function(n){if(0===n.length)return!1;if(1===n.length)return!0;var i=e(n[0].value);return 0===t.grep(n,function(t){return 0===e(t.value).indexOf(i)},!0).length}}var n=e(function(t){return t}),i=e(function(t){return t.replace(/, (?:д|вл|двлд|к) .+$/,"")});return{matchByNormalizedQuery:function(e,n){var i=e.toLowerCase(),o=this&&this.stopwords,r=Ze.normalize(i,o),s=[];return t.each(n,function(t,e){var n=e.value.toLowerCase();return!Ze.stringEncloses(i,n)&&(!(n.indexOf(r)>0)&&void(r===Ze.normalize(n,o)&&s.push(t)))}),1===s.length?s[0]:-1},matchByWords:function(e,i){var o,r=this&&this.stopwords,s=e.toLowerCase(),a=[];return n(i)&&(o=Ze.withSubTokens(Ze.getWords(s,r)),t.each(i,function(t,e){var n=e.value.toLowerCase();if(Ze.stringEncloses(s,n))return!1;var i=Ze.withSubTokens(Ze.getWords(n,r));0===Ze.arrayMinus(o,i).length&&a.push(t)})),1===a.length?a[0]:-1},matchByWordsAddress:function(e,n){var o,r=this&&this.stopwords,s=e.toLowerCase(),a=-1;return i(n)&&(o=Ze.withSubTokens(Ze.getWords(s,r)),t.each(n,function(t,e){var n=e.value.toLowerCase();if(Ze.stringEncloses(s,n))return!1;var i=Ze.withSubTokens(Ze.getWords(n,r));return 0===Ze.arrayMinus(o,i).length?(a=t,!1):void 0})),a},matchByFields:function(e,n){var i=this&&this.stopwords,o=this&&this.fieldsStopwords,r=Ze.withSubTokens(Ze.getWords(e.toLowerCase(),i)),s=[];return 1===n.length&&(o&&t.each(o,function(t,e){var i=Ze.getDeepValue(n[0],t),o=i&&Ze.withSubTokens(Ze.getWords(i.toLowerCase(),e));o&&o.length&&(s=s.concat(o))}),0===Ze.arrayMinusWithPartialMatching(r,s).length)?0:-1}}}(),en={autoSelectFirst:!1,serviceUrl:"https://suggestions.dadata.ru/suggestions/api/4_1/rs",url:null,onSearchStart:t.noop,onSearchComplete:t.noop,onSearchError:t.noop,onSuggestionsFetch:null,onSelect:null,onSelectNothing:null,onInvalidateSelection:null,minChars:1,deferRequestBy:100,params:{},paramName:"query",timeout:3e3,formatResult:null,formatSelected:null,noCache:!1,containerClass:"suggestions-suggestions",tabDisabled:!1,triggerSelectOnSpace:!1,triggerSelectOnEnter:!0,triggerSelectOnBlur:!0,preventBadQueries:!1,hint:"Выберите вариант или продолжите ввод",noSuggestionsHint:{NAME:"Неизвестное ФИО",ADDRESS:"Неизвестный адрес",EMAIL:"Неизвестная эл. почта",PARTY:"Неизвестная организация",BANK:"Неизвестный банк"},type:null,requestMode:"suggest",count:5,$helpers:null,headers:null,scrollOnFocus:!0,mobileWidth:980,initializeInterval:100},nn=["ао","аобл","дом","респ","а/я","аал","автодорога","аллея","арбан","аул","б-р","берег","бугор","вал","вл","волость","въезд","высел","г","городок","гск","д","двлд","днп","дор","дп","ж/д_будка","ж/д_казарм","ж/д_оп","ж/д_платф","ж/д_пост","ж/д_рзд","ж/д_ст","жилзона","жилрайон","жт","заезд","заимка","зона","к","казарма","канал","кв","кв-л","км","кольцо","комн","кордон","коса","кп","край","линия","лпх","м","массив","местность","мкр","мост","н/п","наб","нп","обл","округ","остров","оф","п","п/о","п/р","п/ст","парк","пгт","пер","переезд","пл","пл-ка","платф","погост","полустанок","починок","пр-кт","проезд","промзона","просек","просека","проселок","проток","протока","проулок","р-н","рзд","россия","рп","ряды","с","с/а","с/мо","с/о","с/п","с/с","сад","сквер","сл","снт","спуск","ст","ст-ца","стр","тер","тракт","туп","у","ул","уч-к","ф/х","ферма","х","ш","бульвар","владение","выселки","гаражно-строительный","город","деревня","домовладение","дорога","квартал","километр","комната","корпус","литер","леспромхоз","местечко","микрорайон","набережная","область","переулок","платформа","площадка","площадь","поселение","поселок","проспект","разъезд","район","республика","село","сельсовет","слобода","сооружение","станица","станция","строение","территория","тупик","улица","улус","участок","хутор","шоссе"],on=[{id:"kladr_id",fields:["kladr_id"],forBounds:!1,forLocations:!0},{id:"postal_code",fields:["postal_code"],forBounds:!1,forLocations:!0},{id:"country",fields:["country"],forBounds:!1,forLocations:!0},{id:"region_fias_id",fields:["region_fias_id"],forBounds:!1,forLocations:!0},{id:"region_type_full",fields:["region_type_full"],forBounds:!1,forLocations:!0,kladrFormat:{digits:2,zeros:11},fiasType:"region_fias_id"},{id:"region",fields:["region","region_type","region_type_full","region_with_type"],forBounds:!0,forLocations:!0,kladrFormat:{digits:2,zeros:11},fiasType:"region_fias_id"},{id:"area_fias_id",fields:["area_fias_id"],forBounds:!1,forLocations:!0},{id:"area_type_full",fields:["area_type_full"],forBounds:!1,forLocations:!0,kladrFormat:{digits:5,zeros:8},fiasType:"area_fias_id"},{id:"area",fields:["area","area_type","area_type_full","area_with_type"],forBounds:!0,forLocations:!0,kladrFormat:{digits:5,zeros:8},fiasType:"area_fias_id"},{id:"city_fias_id",fields:["city_fias_id"],forBounds:!1,forLocations:!0},{id:"city_type_full",fields:["city_type_full"],forBounds:!1,forLocations:!0,kladrFormat:{digits:8,zeros:5},fiasType:"city_fias_id"},{id:"city",fields:["city","city_type","city_type_full","city_with_type"],forBounds:!0,forLocations:!0,kladrFormat:{digits:8,zeros:5},fiasType:"city_fias_id"},{id:"city_district_fias_id",fields:["city_district_fias_id"],forBounds:!1,forLocations:!0},{id:"city_district_type_full",fields:["city_district_type_full"],forBounds:!1,forLocations:!0,kladrFormat:{digits:11,zeros:2},fiasType:"city_district_fias_id"},{id:"city_district",fields:["city_district","city_district_type","city_district_type_full","city_district_with_type"],forBounds:!0,forLocations:!0,kladrFormat:{digits:11,zeros:2},fiasType:"city_district_fias_id"},{id:"settlement_fias_id",fields:["settlement_fias_id"],forBounds:!1,forLocations:!0},{id:"settlement_type_full",fields:["settlement_type_full"],forBounds:!1,forLocations:!0,kladrFormat:{digits:11,zeros:2},fiasType:"settlement_fias_id"},{id:"settlement",fields:["settlement","settlement_type","settlement_type_full","settlement_with_type"],forBounds:!0,forLocations:!0,kladrFormat:{digits:11,zeros:2},fiasType:"settlement_fias_id"},{id:"street_fias_id",fields:["street_fias_id"],forBounds:!1,forLocations:!0},{id:"street_type_full",fields:["street_type_full"],forBounds:!1,forLocations:!0,kladrFormat:{digits:15,zeros:2},fiasType:"street_fias_id"},{id:"street",fields:["street","street_type","street_type_full","street_with_type"],forBounds:!0,forLocations:!0,kladrFormat:{digits:15,zeros:2},fiasType:"street_fias_id"},{id:"house",fields:["house","house_type","house_type_full","block","block_type"],forBounds:!0,forLocations:!1,kladrFormat:{digits:19}}],rn=/<strong>/,sn={LEGAL:[2,2,5,1],INDIVIDUAL:[2,2,6,2]},an={};an.NAME={urlSuffix:"fio",matchers:[tn.matchByNormalizedQuery,tn.matchByWords],fieldNames:{surname:"фамилия",name:"имя",patronymic:"отчество"},alwaysContinueSelecting:!0,isDataComplete:function(e){var n,o=this,r=o.options.params,s=e.data;return t.isFunction(r)&&(r=r.call(o.element,e.value)),r&&r.parts?n=t.map(r.parts,function(t){return t.toLowerCase()}):(n=["surname","name"],i(e,"surname")&&n.push("patronymic")),Ze.fieldsNotEmpty(s,n)},composeValue:function(t){return Ze.compact([t.surname,t.name,t.patronymic]).join(" ")}},an.ADDRESS={urlSuffix:"address",matchers:[t.proxy(tn.matchByNormalizedQuery,{stopwords:nn}),t.proxy(tn.matchByWordsAddress,{stopwords:nn})],dataComponents:on,dataComponentsById:Ze.indexBy(on,"id","index"),unformattableTokens:nn,enrichmentEnabled:!0,geoEnabled:!0,isDataComplete:function(e){var n=[this.bounds.to||"flat"],i=e.data;return!t.isPlainObject(i)||Ze.fieldsNotEmpty(i,n)},composeValue:function(t,e){var n=t.region_with_type||Ze.compact([t.region,t.region_type]).join(" ")||t.region_type_full,i=t.area_with_type||Ze.compact([t.area_type,t.area]).join(" ")||t.area_type_full,o=t.city_with_type||Ze.compact([t.city_type,t.city]).join(" ")||t.city_type_full,r=t.settlement_with_type||Ze.compact([t.settlement_type,t.settlement]).join(" ")||t.settlement_type_full,s=t.city_district_with_type||Ze.compact([t.city_district_type,t.city_district]).join(" ")||t.city_district_type_full,a=t.street_with_type||Ze.compact([t.street_type,t.street]).join(" ")||t.street_type_full,u=Ze.compact([t.house_type,t.house,t.block_type,t.block]).join(" "),c=Ze.compact([t.flat_type,t.flat]).join(" "),l=t.postal_box&&"а/я "+t.postal_box;return n===o&&(n=""),e&&e.saveCityDistrict||(e&&e.excludeCityDistrict?s="":s&&!t.city_district_fias_id&&(s="")),Ze.compact([n,i,o,s,r,a,u,c,l]).join(", ")},formatResult:function(){var e=[],n=!1;return t.each(on,function(){n&&e.push(this.id),"city_district"===this.id&&(n=!0)}),function(n,i,o,r){var s,a,u,c=this,l=o.data&&o.data.city_district_with_type,d=r&&r.unformattableTokens,f=o.data&&o.data.history_values;return f&&f.length>0&&(s=Ze.getTokens(i,d),a=this.type.findUnusedTokens(s,n),(u=this.type.getFormattedHistoryValues(a,f))&&(n+=u)),n=c.highlightMatches(n,i,o,r),n=c.wrapFormattedValue(n,o),l&&(!c.bounds.own.length||c.bounds.own.indexOf("street")>=0)&&!t.isEmptyObject(c.copyDataComponents(o.data,e))&&(n+='<div class="'+c.classes.subtext+'">'+c.highlightMatches(l,i,o)+"</div>"),n}}(),findUnusedTokens:function(t,e){var n,i,o=[];for(n in t)i=t[n],-1===e.indexOf(i)&&o.push(i);return o},getFormattedHistoryValues:function(t,e){var n,i,o,r,s=[],a="";for(o in e){r=e[o];for(n in t)if(i=t[n],r.toLowerCase().indexOf(i)>=0){s.push(r);break}}return s.length>0&&(a=" (бывш. "+s.join(", ")+")"),a},getSuggestionValue:function(t,e){var n=null;return e.hasSameValues?n=t.options.restrict_value?this.getValueWithinConstraints(t,e.suggestion):t.bounds.own.length?this.getValueWithinBounds(t,e.suggestion):e.suggestion.unrestricted_value:e.hasBeenEnriched&&t.options.restrict_value&&(n=this.getValueWithinConstraints(t,e.suggestion,{excludeCityDistrict:!0})),n},getValueWithinConstraints:function(t,e,n){return this.composeValue(t.getUnrestrictedData(e.data),n)},getValueWithinBounds:function(t,e,n){var i=t.copyDataComponents(e.data,t.bounds.own.concat(["city_district_fias_id"]));return this.composeValue(i,n)}},an.PARTY={urlSuffix:"party",matchers:[t.proxy(tn.matchByFields,{fieldsStopwords:{value:null,"data.address.value":nn,"data.inn":null,"data.ogrn":null}})],dataComponents:on,geoEnabled:!0,formatResult:function(t,e,n,i){var s=this,a=s.type.formatResultInn.call(s,n,e),u=s.highlightMatches(Ze.getDeepValue(n.data,"ogrn"),e,n),c=o(a,u),l=s.highlightMatches(Ze.getDeepValue(n.data,"management.name"),e,n),d=Ze.getDeepValue(n.data,"address.value")||"";return s.isMobile&&((i||(i={})).maxLength=50),t=r.call(s,t,Ze.getDeepValue(n.data,"name.latin"),e,n,i),t=s.wrapFormattedValue(t,n),d&&(d=d.replace(/^(\d{6}?\s+|Россия,\s+)/i,""),d=s.isMobile?d.replace(new RegExp("^([^"+Je+"]+["+Je+"]+[^"+Je+"]+).*"),"$1"):s.highlightMatches(d,e,n,{unformattableTokens:nn})),(c||d||l)&&(t+='<div class="'+s.classes.subtext+'"><span class="'+s.classes.subtext_inline+'">'+(c||"")+"</span>"+(o(d,l)||"")+"</div>"),t},formatResultInn:function(e,n){var i,o,r=this,s=e.data&&e.data.inn,a=sn[e.data&&e.data.type],u=/\d/;if(s)return o=r.highlightMatches(s,n,e),a&&(o=o.split(""),i=t.map(a,function(t){for(var e,n="";t&&(e=o.shift());)n+=e,u.test(e)&&t--;return n}),o=i.join('<span class="'+r.classes.subtext_delimiter+'"></span>')+o.join("")),o}},an.EMAIL={urlSuffix:"email",matchers:[tn.matchByNormalizedQuery],isQueryRequestable:function(t){return this.options.suggest_local||t.indexOf("@")>=0}},an.BANK={urlSuffix:"bank",matchers:[t.proxy(tn.matchByFields,{fieldsStopwords:{value:null,"data.bic":null,"data.swift":null}})],dataComponents:on,geoEnabled:!0,formatResult:function(t,e,n,i){var o=this,r=o.highlightMatches(Ze.getDeepValue(n.data,"bic"),e,n),s=Ze.getDeepValue(n.data,"address.value")||"";return t=o.highlightMatches(t,e,n,i),t=o.wrapFormattedValue(t,n),s&&(s=s.replace(/^\d{6}( РОССИЯ)?, /i,""),s=o.isMobile?s.replace(new RegExp("^([^"+Je+"]+["+Je+"]+[^"+Je+"]+).*"),"$1"):o.highlightMatches(s,e,n,{unformattableTokens:nn})),(r||s)&&(t+='<div class="'+o.classes.subtext+'"><span class="'+o.classes.subtext_inline+'">'+r+"</span>"+s+"</div>"),t},formatSelected:function(t){return Ze.getDeepValue(t,"data.name.payment")||null}},t.extend(en,{suggest_local:!0});var un={chains:{},on:function(t,e){return this.get(t).push(e),this},get:function(t){var e=this.chains;return e[t]||(e[t]=[])}},cn={suggest:{defaultParams:{type:Ze.getDefaultType(),dataType:"json",contentType:Ze.getDefaultContentType()},addTypeInUrl:!0},detectAddressByIp:{defaultParams:{type:"GET",dataType:"json"},addTypeInUrl:!1},status:{defaultParams:{type:"GET",dataType:"json"},addTypeInUrl:!0},findById:{defaultParams:{type:Ze.getDefaultType(),dataType:"json",contentType:Ze.getDefaultContentType()},addTypeInUrl:!0}},ln={suggest:{method:"suggest",userSelect:!0,updateValue:!0,enrichmentEnabled:!0},findById:{method:"findById",userSelect:!1,updateValue:!1,enrichmentEnabled:!1}};s.prototype={initialize:function(){var t=this;t.uniqueId=Ze.uniqueId("i"),t.createWrapper(),t.notify("initialize"),t.bindWindowEvents(),t.setOptions(),t.fixPosition()},deferInitialization:function(){var t,e=this,n="mouseover focus keydown",i=function(){e.initializer.resolve(),e.enable()};e.initializer.always(function(){e.el.off(n,i),clearInterval(t)}),e.disabled=!0,e.el.on(n,i),t=setInterval(function(){e.el.is(":visible")&&i()},e.options.initializeInterval)},isInitialized:function(){return"resolved"===this.initializer.state()},dispose:function(){var t=this;t.initializer.reject(),t.notify("dispose"),t.el.removeData("suggestions").removeClass("suggestions-input"),t.unbindWindowEvents(),t.removeWrapper(),t.el.trigger("suggestions-dispose")},notify:function(e){var n=this,i=Ze.slice(arguments,1);return t.map(un.get(e),function(t){return t.apply(n,i)})},createWrapper:function(){var e=this;e.$wrapper=t('<div class="suggestions-wrapper"/>'),e.el.after(e.$wrapper),e.$wrapper.on("mousedown"+Ge,t.proxy(e.onMousedown,e))},removeWrapper:function(){var e=this;e.$wrapper&&e.$wrapper.remove(),t(e.options.$helpers).off(Ge)},onMousedown:function(e){var n=this;e.preventDefault(),n.cancelBlur=!0,
Ze.delay(function(){delete n.cancelBlur}),0==t(e.target).closest(".ui-menu-item").length&&Ze.delay(function(){t(document).one("mousedown",function(e){var i=n.el.add(n.$wrapper).add(n.options.$helpers);n.options.floating&&(i=i.add(n.$container)),i=i.filter(function(){return this===e.target||t.contains(this,e.target)}),i.length||n.hide()})})},bindWindowEvents:function(){var e=this,n=t.proxy(e.fixPosition,e);e.$viewport.on("resize"+Ge+e.uniqueId,n).on("scroll"+Ge+e.uniqueId,n)},unbindWindowEvents:function(){this.$viewport.off("resize"+Ge+this.uniqueId).off("scroll"+Ge+this.uniqueId)},scrollToTop:function(){var e=this,n=e.options.scrollOnFocus;!0===n&&(n=e.el),n instanceof t&&n.length>0&&t("body,html").animate({scrollTop:n.offset().top},"fast")},setOptions:function(e){var n=this;t.extend(n.options,e),t.each({type:an,requestMode:ln},function(e,i){if(n[e]=i[n.options[e]],!n[e])throw n.disable(),"`"+e+"` option is incorrect! Must be one of: "+t.map(i,function(t,e){return'"'+e+'"'}).join(", ")}),t(n.options.$helpers).off(Ge).on("mousedown"+Ge,t.proxy(n.onMousedown,n)),n.isInitialized()&&n.notify("setOptions")},fixPosition:function(e){var n,i,o=this,r={};o.isMobile=o.$viewport.width()<=o.options.mobileWidth,o.isInitialized()&&(!e||"scroll"!=e.type||o.options.floating||o.isMobile)&&(o.$container.appendTo(o.options.floating?o.$body:o.$wrapper),o.notify("resetPosition"),o.el.css("paddingLeft",""),o.el.css("paddingRight",""),r.paddingLeft=parseFloat(o.el.css("paddingLeft")),r.paddingRight=parseFloat(o.el.css("paddingRight")),t.extend(r,o.el.offset()),r.borderTop="none"==o.el.css("border-top-style")?0:parseFloat(o.el.css("border-top-width")),r.borderLeft="none"==o.el.css("border-left-style")?0:parseFloat(o.el.css("border-left-width")),r.innerHeight=o.el.innerHeight(),r.innerWidth=o.el.innerWidth(),r.outerHeight=o.el.outerHeight(),r.componentsLeft=0,r.componentsRight=0,n=o.$wrapper.offset(),i={top:r.top-n.top,left:r.left-n.left},o.notify("fixPosition",i,r),r.componentsLeft>r.paddingLeft&&o.el.css("paddingLeft",r.componentsLeft+"px"),r.componentsRight>r.paddingRight&&o.el.css("paddingRight",r.componentsRight+"px"))},clearCache:function(){this.cachedResponse={},this.enrichmentCache={},this.badQueries=[]},clear:function(){var t=this;t.isInitialized()&&(t.clearCache(),t.currentValue="",t.selection=null,t.hide(),t.suggestions=[],t.el.val(""),t.el.trigger("suggestions-clear"),t.notify("clear"))},disable:function(){var t=this;t.disabled=!0,t.abortRequest(),t.visible&&t.hide()},enable:function(){this.disabled=!1},isUnavailable:function(){return this.disabled},update:function(){var t=this,e=t.el.val();t.isInitialized()&&(t.currentValue=e,t.isQueryRequestable(e)?t.updateSuggestions(e):t.hide())},setSuggestion:function(e){var n,i,o=this;t.isPlainObject(e)&&t.isPlainObject(e.data)&&(e=t.extend(!0,{},e),o.bounds.own.length&&(o.checkValueBounds(e),n=o.copyDataComponents(e.data,o.bounds.all),e.data.kladr_id&&(n.kladr_id=o.getBoundedKladrId(e.data.kladr_id,o.bounds.all)),e.data=n),o.selection=e,o.suggestions=[e],i=o.getSuggestionValue(e)||"",o.currentValue=i,o.el.val(i),o.abortRequest(),o.el.trigger("suggestions-set"))},fixData:function(){var e=this,n=e.extendedCurrentValue(),i=e.el.val(),o=t.Deferred();o.done(function(t){e.selectSuggestion(t,0,i,{hasBeenEnriched:!0}),e.el.trigger("suggestions-fixdata",t)}).fail(function(){e.selection=null,e.currentValue="",e.el.val(e.currentValue),e.el.trigger("suggestions-fixdata")}),e.isQueryRequestable(n)?(e.currentValue=n,e.getSuggestions(n,{count:1,from_bound:null,to_bound:null}).done(function(t){var e=t[0];e?o.resolve(e):o.reject()}).fail(function(){o.reject()})):o.reject()},extendedCurrentValue:function(){var e=this,n=e.getParentInstance(),i=n&&n.extendedCurrentValue(),o=t.trim(e.el.val());return Ze.compact([i,o]).join(" ")},getAjaxParams:function(e,n){var i=this,o=t.trim(i.options.token),r=t.trim(i.options.partner),a=i.options.serviceUrl,u=i.options.url,c=cn[e],l=t.extend({timeout:i.options.timeout},c.defaultParams),d={};return u?a=u:(/\/$/.test(a)||(a+="/"),a+=e,c.addTypeInUrl&&(a+="/"+i.type.urlSuffix)),a=Ze.fixURLProtocol(a),t.support.cors?(o&&(d.Authorization="Token "+o),r&&(d["X-Partner"]=r),d["X-Version"]=s.version,l.headers||(l.headers={}),t.extend(l.headers,i.options.headers,d)):(o&&(d.token=o),r&&(d.partner=r),d.version=s.version,a=Ze.addUrlParams(a,d)),l.url=a,t.extend(l,n)},isQueryRequestable:function(t){var e,n=this;return e=t.length>=n.options.minChars,e&&n.type.isQueryRequestable&&(e=n.type.isQueryRequestable.call(n,t)),e},constructRequestParams:function(e,n){var i=this,o=i.options,r=t.isFunction(o.params)?o.params.call(i.element,e):t.extend({},o.params);return i.type.constructRequestParams&&t.extend(r,i.type.constructRequestParams.call(i)),t.each(i.notify("requestParams"),function(e,n){t.extend(r,n)}),r[o.paramName]=e,t.isNumeric(o.count)&&o.count>0&&(r.count=o.count),t.extend(r,n)},updateSuggestions:function(t){var e=this;e.fetchPhase=e.getSuggestions(t).done(function(n){e.assignSuggestions(n,t)})},getSuggestions:function(e,n,i){var o,r=this,s=r.options,a=i&&i.noCallbacks,u=i&&i.useEnrichmentCache,c=r.constructRequestParams(e,n),l=t.param(c||{}),d=t.Deferred();return o=r.cachedResponse[l],o&&t.isArray(o.suggestions)?d.resolve(o.suggestions):r.isBadQuery(e)?d.reject():a||!1!==s.onSearchStart.call(r.element,c)?r.doGetSuggestions(c).done(function(t){r.processResponse(t)&&e==r.currentValue?(s.noCache||(u?r.enrichmentCache[e]=t.suggestions[0]:(r.enrichResponse(t,e),r.cachedResponse[l]=t,s.preventBadQueries&&0===t.suggestions.length&&r.badQueries.push(e))),d.resolve(t.suggestions)):d.reject(),a||s.onSearchComplete.call(r.element,e,t.suggestions)}).fail(function(t,n,i){d.reject(),a||"abort"===n||s.onSearchError.call(r.element,e,t,n,i)}):d.reject(),d},doGetSuggestions:function(e){var n=this,i=t.ajax(n.getAjaxParams(n.requestMode.method,{data:Ze.serialize(e)}));return n.abortRequest(),n.currentRequest=i,n.notify("request"),i.always(function(){n.currentRequest=null,n.notify("request")}),i},isBadQuery:function(e){if(!this.options.preventBadQueries)return!1;var n=!1;return t.each(this.badQueries,function(t,i){return!(n=0===e.indexOf(i))}),n},abortRequest:function(){var t=this;t.currentRequest&&t.currentRequest.abort()},processResponse:function(e){var n,i=this;return!(!e||!t.isArray(e.suggestions))&&(i.verifySuggestionsFormat(e.suggestions),i.setUnrestrictedValues(e.suggestions),t.isFunction(i.options.onSuggestionsFetch)&&(n=i.options.onSuggestionsFetch.call(i.element,e.suggestions),t.isArray(n)&&(e.suggestions=n)),!0)},verifySuggestionsFormat:function(e){"string"==typeof e[0]&&t.each(e,function(t,n){e[t]={value:n,data:null}})},getSuggestionValue:function(e,n){var i,o=this,r=o.options.formatSelected||o.type.formatSelected,s=n&&n.hasSameValues,a=n&&n.hasBeenEnriched,u=null;return t.isFunction(r)&&(i=r.call(o,e)),"string"!=typeof i&&(i=e.value,o.type.getSuggestionValue&&null!==(u=o.type.getSuggestionValue(o,{suggestion:e,hasSameValues:s,hasBeenEnriched:a}))&&(i=u)),i},hasSameValues:function(e){var n=!1;return t.each(this.suggestions,function(t,i){if(i.value===e.value&&i!==e)return n=!0,!1}),n},assignSuggestions:function(t,e){var n=this;n.suggestions=t,n.notify("assignSuggestions",e)},shouldRestrictValues:function(){var t=this;return t.options.restrict_value&&t.constraints&&1==ct(t.constraints).length},setUnrestrictedValues:function(e){var n=this,i=n.shouldRestrictValues(),o=n.getFirstConstraintLabel();t.each(e,function(t,e){e.unrestricted_value||(e.unrestricted_value=i?o+", "+e.value:e.value)})},areSuggestionsSame:function(t,e){return t&&e&&t.value===e.value&&Ze.areSame(t.data,e.data)}};var dn=Object.assign,fn=!dn||K(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=dn({},t)[n]||Object.keys(dn({},e)).join("")!=i})?function(t,e){for(var n=h(t),i=arguments.length,o=1,r=Qt.f,s=Jt.f;i>o;)for(var a,u=b(arguments[o++]),c=r?q(u).concat(r(u)):q(u),l=c.length,d=0;l>d;)s.call(u,a=c[d++])&&(n[a]=u[a]);return n}:dn;st(st.S+st.F,"Object",{assign:fn});var pn,hn,gn,vn=N.Object.assign,yn=n(function(t){t.exports={default:vn,__esModule:!0}}),mn=e(yn),bn=mt("toStringTag"),_n="Arguments"==m(function(){return arguments}()),wn=function(t,e){try{return t[e]}catch(t){}},xn=function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=wn(e=Object(t),bn))?n:_n?m(e):"Object"==(i=m(e))&&"function"==typeof e.callee?"Arguments":i},Sn=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t},Cn=function(t,e,n,i){try{return i?e(H(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&H(o.call(t)),e}},En=mt("iterator"),Pn=Array.prototype,kn=function(t){return void 0!==t&&(dt.Array===t||Pn[En]===t)},jn=mt("iterator"),On=N.getIteratorMethod=function(t){if(void 0!=t)return t[jn]||t["@@iterator"]||dt[xn(t)]},Tn=n(function(t){var e={},n={},i=t.exports=function(t,i,o,r,s){var a,u,c,l,d=s?function(){return t}:On(t),f=z(o,r,i?2:1),p=0;if("function"!=typeof d)throw TypeError(t+" is not iterable!");if(kn(d)){for(a=E(t.length);a>p;p++)if((l=i?f(H(u=t[p])[0],u[1]):f(t[p]))===e||l===n)return l}else for(c=d.call(t);!(u=c.next()).done;)if((l=Cn(c,f,u.value,i))===e||l===n)return l};i.BREAK=e,i.RETURN=n}),Ln=mt("species"),Rn=function(t,e){var n,i=H(t).constructor;return void 0===i||void 0==(n=H(i)[Ln])?e:W(n)},In=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)},Vn=O.process,Bn=O.setImmediate,Fn=O.clearImmediate,Dn=O.MessageChannel,Mn=0,An={},$n=function(){var t=+this;if(An.hasOwnProperty(t)){var e=An[t];delete An[t],e()}},qn=function(t){$n.call(t.data)};Bn&&Fn||(Bn=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return An[++Mn]=function(){In("function"==typeof t?t:Function(t),e)},pn(Mn),Mn},Fn=function(t){delete An[t]},"process"==m(Vn)?pn=function(t){Vn.nextTick(z($n,t,1))}:Dn?(hn=new Dn,gn=hn.port2,hn.port1.onmessage=qn,pn=z(gn.postMessage,gn,1)):O.addEventListener&&"function"==typeof postMessage&&!O.importScripts?(pn=function(t){O.postMessage(t+"","*")},O.addEventListener("message",qn,!1)):pn="onreadystatechange"in X("script")?function(t){pt.appendChild(X("script")).onreadystatechange=function(){pt.removeChild(this),$n.call(t)}}:function(t){setTimeout(z($n,t,1),0)});var Nn={set:Bn,clear:Fn},Wn=Nn.set,zn=O.MutationObserver||O.WebKitMutationObserver,Un=O.process,Hn=O.Promise,Kn="process"==m(Un),Qn=mt("species"),Gn=mt("iterator"),Jn=!1;try{var Xn=[7][Gn]();Xn.return=function(){Jn=!0},Array.from(Xn,function(){throw 2})}catch(t){}var Yn,Zn,ti,ei=Nn.set,ni=function(){var t,e,n,i=function(){var i,o;for(Kn&&(i=Un.domain)&&i.exit();t;){o=t.fn,t=t.next;try{o()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(Kn)n=function(){Un.nextTick(i)};else if(zn){var o=!0,r=document.createTextNode("");new zn(i).observe(r,{characterData:!0}),n=function(){r.data=o=!o}}else if(Hn&&Hn.resolve){var s=Hn.resolve();n=function(){s.then(i)}}else n=function(){Wn.call(O,i)};return function(i){var o={fn:i,next:void 0};e&&(e.next=o),t||(t=o,n()),e=o}}(),ii=O.TypeError,oi=O.process,ri=O.Promise,oi=O.process,si="process"==xn(oi),ai=function(){},ui=!!function(){try{var t=ri.resolve(1),e=(t.constructor={})[mt("species")]=function(t){t(ai,ai)};return(si||"function"==typeof PromiseRejectionEvent)&&t.then(ai)instanceof e}catch(t){}}(),ci=function(t,e){return t===e||t===ri&&e===ti},li=function(t){var e;return!(!U(t)||"function"!=typeof(e=t.then))&&e},di=function(t){return ci(ri,t)?new fi(t):new Zn(t)},fi=Zn=function(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw ii("Bad Promise constructor");e=t,n=i}),this.resolve=W(e),this.reject=W(n)},pi=function(t){try{t()}catch(t){return{error:t}}},hi=function(t,e){if(!t._n){t._n=!0;var n=t._c;ni(function(){for(var i=t._v,o=1==t._s,r=0;n.length>r;)!function(e){var n,r,s=o?e.ok:e.fail,a=e.resolve,u=e.reject,c=e.domain;try{s?(o||(2==t._h&&yi(t),t._h=1),!0===s?n=i:(c&&c.enter(),n=s(i),c&&c.exit()),n===e.promise?u(ii("Promise-chain cycle")):(r=li(n))?r.call(n,a,u):a(n)):u(i)}catch(t){u(t)}}(n[r++]);t._c=[],t._n=!1,e&&!t._h&&gi(t)})}},gi=function(t){ei.call(O,function(){var e,n,i,o=t._v;if(vi(t)&&(e=pi(function(){si?oi.emit("unhandledRejection",o,t):(n=O.onunhandledrejection)?n({promise:t,reason:o}):(i=O.console)&&i.error&&i.error("Unhandled promise rejection",o)}),t._h=si||vi(t)?2:1),t._a=void 0,e)throw e.error})},vi=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,i=0;n.length>i;)if(e=n[i++],e.fail||!vi(e.promise))return!1;return!0},yi=function(t){ei.call(O,function(){var e;si?oi.emit("rejectionHandled",t):(e=O.onrejectionhandled)&&e({promise:t,reason:t._v})})},mi=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),hi(e,!0))},bi=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw ii("Promise can't be resolved itself");(e=li(t))?ni(function(){var i={_w:n,_d:!1};try{e.call(t,z(bi,i,1),z(mi,i,1))}catch(t){mi.call(i,t)}}):(n._v=t,n._s=1,hi(n,!1))}catch(t){mi.call({_w:n,_d:!1},t)}}};ui||(ri=function(t){Sn(this,ri,"Promise","_h"),W(t),Yn.call(this);try{t(z(bi,this,1),z(mi,this,1))}catch(t){mi.call(this,t)}},Yn=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},Yn.prototype=function(t,e,n){for(var i in e)n&&t[i]?t[i]=e[i]:ot(t,i,e[i]);return t}(ri.prototype,{then:function(t,e){var n=di(Rn(this,ri));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=si?oi.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&hi(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),fi=function(){var t=new Yn;this.promise=t,this.resolve=z(bi,t,1),this.reject=z(mi,t,1)}),st(st.G+st.W+st.F*!ui,{Promise:ri}),wt(ri,"Promise"),function(t){var e="function"==typeof N[t]?N[t]:O[t];Q&&e&&!e[Qn]&&nt.f(e,Qn,{configurable:!0,get:function(){return this}})}("Promise"),ti=N.Promise,st(st.S+st.F*!ui,"Promise",{reject:function(t){var e=di(this);return(0,e.reject)(t),e.promise}}),st(st.S+!0*st.F,"Promise",{resolve:function(t){if(t instanceof ri&&ci(t.constructor,this))return t;var e=di(this);return(0,e.resolve)(t),e.promise}}),st(st.S+st.F*!(ui&&function(t,e){if(!e&&!Jn)return!1;var n=!1;try{var i=[7],o=i[Gn]();o.next=function(){return{done:n=!0}},i[Gn]=function(){return o},t(i)}catch(t){}return n}(function(t){ri.all(t).catch(ai)})),"Promise",{all:function(t){var e=this,n=di(e),i=n.resolve,o=n.reject,r=pi(function(){var n=[],r=0,s=1;Tn(t,!1,function(t){var a=r++,u=!1;n.push(void 0),s++,e.resolve(t).then(function(t){u||(u=!0,n[a]=t,--s||i(n))},o)}),--s||i(n)});return r&&o(r.error),n.promise},race:function(t){var e=this,n=di(e),i=n.reject,o=pi(function(){Tn(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return o&&i(o.error),n.promise}});var _i=N.Promise,wi=n(function(t){t.exports={default:_i,__esModule:!0}}),xi=e(wi),Si={},Ci={addClass:function(t,e){var n=t.className.split(" ");-1===n.indexOf(e)&&n.push(e),t.className=n.join(" ")},setStyle:function(t,e,n){t.style[e]=n},listen:function(t,e,n,i){t.addEventListener(e,i,!1),n&&(Si[n]||(Si[n]=[]),Si[n].push({eventName:e,element:t,callback:i}))},stopListenByNamespace:function(t){var e=Si[t];if(e)for(var n in e){var i=e[n];i.element.removeEventListener(i.eventName,i.callback,!1)}},stopListen:function(){}},Ei={setupElement:function(){this.element.setAttribute("autocomplete","off"),Ci.addClass(this.element,"suggestions-input"),Ci.setStyle(this.element,"boxSizing","border-box")},bindElementEvents:function(){Ci.listen(this.element,"keydown",Ge,this.onElementKeyDown.bind(this)),Ci.listen(this.element,"keyup",Ge,this.onElementKeyUp.bind(this)),Ci.listen(this.element,"cut",Ge,this.onElementKeyUp.bind(this)),Ci.listen(this.element,"paste",Ge,this.onElementKeyUp.bind(this)),Ci.listen(this.element,"input",Ge,this.onElementKeyUp.bind(this)),Ci.listen(this.element,"blur",Ge,this.onElementBlur.bind(this)),Ci.listen(this.element,"focus",Ge,this.onElementFocus.bind(this))},unbindElementEvents:function(){Ci.stopListenByNamespace(Ge)},onElementBlur:function(){var t=this;if(this.cancelBlur)return void(this.cancelBlur=!1);this.options.triggerSelectOnBlur?this.isUnavailable()||this.selectCurrentValue({noSpace:!0}).always(function(){t.hide()}):this.hide(),this.fetchPhase.abort&&this.fetchPhase.abort()},onElementFocus:function(){this.cancelFocus||Ze.delay(this.completeOnFocus.bind(this)),this.cancelFocus=!1},onElementKeyDown:function(t){var e=this;if(!this.isUnavailable())if(this.visible){switch(t.key){case Qe.ESC:this.el.val(this.currentValue),this.hide(),this.abortRequest();break;case Qe.TAB:if(!1===this.options.tabDisabled)return;break;case Qe.ENTER:this.options.triggerSelectOnEnter&&this.selectCurrentValue();break;case Qe.SPACE:return void(this.options.triggerSelectOnSpace&&this.isCursorAtEnd()&&(t.preventDefault(),this.selectCurrentValue({continueSelecting:!0,dontEnrich:!0}).fail(function(){e.currentValue+=" ",e.el.val(e.currentValue),e.proceedChangedValue()})));case Qe.UP:this.moveUp();break;case Qe.DOWN:this.moveDown();break;default:return}t.stopImmediatePropagation(),t.preventDefault()}else switch(t.key){case Qe.DOWN:this.suggest();break;case Qe.ENTER:this.options.triggerSelectOnEnter&&this.triggerOnSelectNothing()}},onElementKeyUp:function(t){if(!this.isUnavailable()){switch(t.key){case Qe.UP:case Qe.DOWN:case Qe.ENTER:return}clearTimeout(this.onChangeTimeout),this.inputPhaseReject(),this.currentValue!==this.el.val()&&this.proceedChangedValue()}},proceedChangedValue:function(){var t=this;this.abortRequest(),this.inputPhase=new xi(function(e,n){t.inputPhaseResolve=e,t.inputPhaseReject=n}).then(this.onValueChange.bind(this),function(){}),this.options.deferRequestBy>0?this.onChangeTimeout=Ze.delay(function(){t.inputPhaseResolve()},this.options.deferRequestBy):this.inputPhaseResolve()},onValueChange:function(){var t=void 0;this.selection&&(t=this.selection,this.selection=null,this.trigger("InvalidateSelection",t)),this.selectedIndex=-1,this.update(),this.notify("valueChange")},completeOnFocus:function(){this.isUnavailable()||this.isElementFocused()&&(this.fixPosition(),this.update(),this.isMobile&&(this.setCursorAtEnd(),this.scrollToTop()))},isElementFocused:function(){return document.activeElement===this.element},isCursorAtEnd:function(){var t=this.el.val().length,e=void 0,n=void 0;try{if("number"==typeof(e=this.element.selectionStart))return e===t}catch(t){}return!document.selection||(n=document.selection.createRange(),n.moveStart("character",-t),t===n.text.length)},setCursorAtEnd:function(){var t=this.element;try{t.selectionEnd=t.selectionStart=t.value.length,t.scrollLeft=t.scrollWidth}catch(e){t.value=t.value}}};mn(s.prototype,Ei),un.on("initialize",Ei.bindElementEvents).on("dispose",Ei.unbindElementEvents);var Pi=function(t,e){Ze.each(e,function(e,n){t.setRequestHeader(n,e)})},ki={send:function(t){var e=void 0,n=void 0,i=void 0,o=void 0,r=void 0;if(o=new xi(function(t,e){n=t,i=e}),window.ActiveXObject?e=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(e=new XMLHttpRequest),e){e.onreadystatechange=function(){var t=void 0;if(4===e.readyState)if(window.clearTimeout(r),e.status>=200&&e.status<300||304===e.status){var o=e.responseText;try{t=JSON.parse(o)}catch(t){}n(t,e)}else i(e)},"GET"===t.type?e.open("GET",t.url,!0):e.open(t.type,t.url,!0),Pi(e,mn({"Content-type":"application/json"},t.headers));try{e.send()}catch(t){i()}t.timeout&&(r=window.setTimeout(function(){i("timeout")},t.timeout))}return o.xhr=e,o}},ji={};a();var Oi={checkStatus:function(){var t=this,e=this.options.token&&this.options.token.trim(),n=this.options.type+e,i=ji[n];i||(i=ji[n]=ki.send(this.getAjaxParams("status"))),i.then(function(e){e.search?mn(t.status,e):o("Service Unavailable")}).catch(function(t){o(t.statusText)});var o=function(e){Ze.isFunction(t.options.onSearchError)&&t.options.onSearchError.call(t.element,null,i,"error",e)}}};s.resetTokens=a,mn(s.prototype,Oi),un.on("setOptions",Oi.checkStatus);var Ti=void 0,Li=!0,Ri={checkLocation:function(){var e=this,n=this.options.geoLocation;this.type.geoEnabled&&n&&(this.geoLocation=t.Deferred(),t.isPlainObject(n)||t.isArray(n)?this.geoLocation.resolve(n):(Ti||(Ti=t.ajax(this.getAjaxParams("detectAddressByIp"))),Ti.done(function(t){var n=t&&t.location&&t.location.data;n&&n.kladr_id?e.geoLocation.resolve(n):e.geoLocation.reject()}).fail(function(){e.geoLocation.reject()})))},getGeoLocation:function(){return this.geoLocation},constructParams:function(){var e={};return this.geoLocation&&t.isFunction(this.geoLocation.promise)&&"resolved"==this.geoLocation.state()&&this.geoLocation.done(function(n){e.locations_boost=t.makeArray(n)}),e}};"GET"!=Ze.getDefaultType()&&(t.extend(en,{geoLocation:Li}),t.extend(s,{resetLocation:u}),t.extend(s.prototype,{getGeoLocation:Ri.getGeoLocation}),un.on("setOptions",Ri.checkLocation).on("requestParams",Ri.constructParams));var Ii={enrichSuggestion:function(e,n){var i=this,o=t.Deferred();return!i.status.enrich||!i.type.enrichmentEnabled||!i.requestMode.enrichmentEnabled||n&&n.dontEnrich?o.resolve(e):e.data&&null!=e.data.qc?o.resolve(e):(i.disableDropdown(),i.currentValue=e.unrestricted_value,i.enrichPhase=i.getSuggestions(e.unrestricted_value,{count:1,locations:null,locations_boost:null,from_bound:null,to_bound:null},{noCallbacks:!0,useEnrichmentCache:!0}).always(function(){i.enableDropdown()}).done(function(t){var n=t&&t[0];o.resolve(n||e,!!n)}).fail(function(){o.resolve(e)}),o)},enrichResponse:function(e,n){var i=this,o=i.enrichmentCache[n];o&&t.each(e.suggestions,function(t,i){if(i.value===n)return e.suggestions[t]=o,!1})}};t.extend(s.prototype,Ii);var Vi={width:"auto",floating:!1},Bi={createContainer:function(){var e=this,n="."+e.classes.suggestion,i=e.options,o=t("<div/>").addClass(i.containerClass).css({position:"absolute",display:"none"});e.$container=o,o.on("click"+Ge,n,t.proxy(e.onSuggestionClick,e))},removeContainer:function(){var t=this;t.options.floating&&t.$container.remove()},setContainerOptions:function(){var e=this;e.$container.off("mousedown.suggestions"),e.options.floating&&e.$container.on("mousedown.suggestions",t.proxy(e.onMousedown,e))},onSuggestionClick:function(e){var n,i=this,o=t(e.target);if(!i.dropdownDisabled){for(i.cancelFocus=!0,i.el.focus();o.length&&!(n=o.attr("data-index"));)o=o.closest("."+i.classes.suggestion);n&&!isNaN(n)&&i.select(+n)}},setDropdownPosition:function(t,e){var n,i=this,o=i.$viewport.scrollLeft();i.isMobile?(n=i.options.floating?{left:o+"px",top:e.top+e.outerHeight+"px"}:{left:t.left-e.left+o+"px",top:t.top+e.outerHeight+"px"},n.width=i.$viewport.width()+"px"):(n=i.options.floating?{left:e.left+"px",top:e.top+e.borderTop+e.innerHeight+"px"}:{left:t.left+"px",top:t.top+e.borderTop+e.innerHeight+"px"},Ze.delay(function(){var t=i.options.width;"auto"===t&&(t=i.el.outerWidth()),i.$container.outerWidth(t)})),i.$container.toggleClass(i.classes.mobile,i.isMobile).css(n),i.containerItemsPadding=e.left+e.borderLeft+e.paddingLeft-o},setItemsPositions:function(){var t=this;t.getSuggestionsItems().css("paddingLeft",t.isMobile?t.containerItemsPadding+"px":"")},getSuggestionsItems:function(){return this.$container.children("."+this.classes.suggestion)},toggleDropdownEnabling:function(t){this.dropdownDisabled=!t,this.$container.attr("disabled",!t)},disableDropdown:function(){this.toggleDropdownEnabling(!1)},enableDropdown:function(){this.toggleDropdownEnabling(!0)},hasSuggestionsToChoose:function(){var e=this;return e.suggestions.length>1||1===e.suggestions.length&&(!e.selection||t.trim(e.suggestions[0].value)!==t.trim(e.selection.value))},suggest:function(){var e,n=this,i=n.options,o=[];if(n.requestMode.userSelect){if(n.hasSuggestionsToChoose())e=i.formatResult||n.type.formatResult||n.formatResult,!n.isMobile&&i.hint&&n.suggestions.length&&o.push('<div class="'+n.classes.hint+'">'+i.hint+"</div>"),n.selectedIndex=-1,t.each(n.suggestions,function(t,i){var r=n.makeSuggestionLabel(n.suggestions,i);i==n.selection&&(n.selectedIndex=t),o.push('<div class="'+n.classes.suggestion+'" data-index="'+t+'">'),o.push(e.call(n,i.value,n.currentValue,i,{unformattableTokens:n.type.unformattableTokens})),r&&o.push('<span class="'+n.classes.subtext_label+'">'+Ze.escapeHtml(r)+"</span>"),o.push("</div>")});else{if(n.suggestions.length)return void n.hide();o.push('<div class="'+n.classes.hint+'">'+i.noSuggestionsHint[i.type]+"</div>")}n.$container.html(o.join("")),i.autoSelectFirst&&-1===n.selectedIndex&&(n.selectedIndex=0),-1!==n.selectedIndex&&n.getSuggestionsItems().eq(n.selectedIndex).addClass(n.classes.selected),t.isFunction(i.beforeRender)&&i.beforeRender.call(n.element,n.$container),n.$container.show(),n.visible=!0,n.fixPosition(),n.setItemsPositions()}},wrapFormattedValue:function(t,e){var n=this,i=Ze.getDeepValue(e.data,"state.status");return'<span class="'+n.classes.value+'"'+(i?' data-suggestion-status="'+i+'"':"")+">"+t+"</span>"},formatResult:function(t,e,n,i){var o=this;return t=o.highlightMatches(t,e,n,i),o.wrapFormattedValue(t,n)},highlightMatches:function(e,n,i,o){var r,s,a,u,d,f,p,h=this,g=[],v=o&&o.unformattableTokens,y=o&&o.maxLength,m=Ze.reWordExtractor();if(!e)return"";for(r=Ze.getTokens(n,v),s=t.map(r,function(t){return new RegExp("^((.*)([\\-\\+\\/\\\\\\?!@#$%^&]+))?("+Ze.escapeRegExChars(t)+")([^\\-\\+\\/\\\\\\?!@#$%^&]*[\\-\\+\\/\\\\\\?!@#$%^&]*)","i")});(a=m.exec(e))&&a[0];)u=a[1],g.push({text:u,hasUpperCase:u.toLowerCase()!==u,formatted:Ze.formatToken(u),matchable:!0}),a[2]&&g.push({text:a[2]});for(d=0;d<g.length;d++)f=g[d],!f.matchable||f.matched||-1!==t.inArray(f.formatted,v)&&!f.hasUpperCase||t.each(s,function(t,e){var n,i=e.exec(f.formatted),o=d+1;if(i)return i={before:i[1]||"",beforeText:i[2]||"",beforeDelimiter:i[3]||"",text:i[4]||"",after:i[5]||""},i.before&&(g.splice(d,0,{text:f.text.substr(0,i.beforeText.length),formatted:i.beforeText,matchable:!0},{text:i.beforeDelimiter}),o+=2,n=i.before.length,f.text=f.text.substr(n),f.formatted=f.formatted.substr(n),d--),n=i.text.length+i.after.length,f.formatted.length>n&&(g.splice(o,0,{text:f.text.substr(n),formatted:f.formatted.substr(n),matchable:!0}),f.text=f.text.substr(0,n),f.formatted=f.formatted.substr(0,n)),i.after&&(n=i.text.length,g.splice(o,0,{text:f.text.substr(n),formatted:f.formatted.substr(n)}),f.text=f.text.substr(0,n),f.formatted=f.formatted.substr(0,n)),f.matched=!0,!1});if(y){for(d=0;d<g.length&&y>=0;d++)f=g[d],(y-=f.text.length)<0&&(f.text=f.text.substr(0,f.text.length+y)+"...");g.length=d}return p=c(g),l(p,h.classes.nowrap)},makeSuggestionLabel:function(e,n){var i,o,r=this,s=r.type.fieldNames,a={},u=Ze.reWordExtractor(),c=[];if(s&&d(e,n)&&n.data&&(t.each(s,function(t){var e=n.data[t];e&&(a[t]=Ze.formatToken(e))}),!t.isEmptyObject(a))){for(;(i=u.exec(Ze.formatToken(n.value)))&&(o=i[1]);)t.each(a,function(t,e){if(e==o)return c.push(s[t]),delete a[t],!1});if(c.length)return c.join(", ")}},hide:function(){var t=this;t.visible=!1,t.selectedIndex=-1,t.$container.hide().empty()},activate:function(t){var e,n,i=this,o=i.classes.selected;return!i.dropdownDisabled&&(n=i.getSuggestionsItems(),n.removeClass(o),i.selectedIndex=t,-1!==i.selectedIndex&&n.length>i.selectedIndex)?(e=n.eq(i.selectedIndex),e.addClass(o),e):null},deactivate:function(t){var e=this;e.dropdownDisabled||(e.selectedIndex=-1,e.getSuggestionsItems().removeClass(e.classes.selected),t&&e.el.val(e.currentValue))},moveUp:function(){var t=this;if(!t.dropdownDisabled)return-1===t.selectedIndex?void(t.suggestions.length&&t.adjustScroll(t.suggestions.length-1)):0===t.selectedIndex?void t.deactivate(!0):void t.adjustScroll(t.selectedIndex-1)},moveDown:function(){var t=this;if(!t.dropdownDisabled)return t.selectedIndex===t.suggestions.length-1?void t.deactivate(!0):void t.adjustScroll(t.selectedIndex+1)},adjustScroll:function(t){var e,n,i,o=this,r=o.activate(t),s=o.$container.scrollTop();r&&r.length&&(e=r.position().top,e<0?o.$container.scrollTop(s+e):(n=e+r.outerHeight(),i=o.$container.innerHeight(),n>i&&o.$container.scrollTop(s-i+n)),o.el.val(o.suggestions[t].value))}};t.extend(en,Vi),t.extend(s.prototype,Bi),un.on("initialize",Bi.createContainer).on("dispose",Bi.removeContainer).on("setOptions",Bi.setContainerOptions).on("fixPosition",Bi.setDropdownPosition).on("fixPosition",Bi.setItemsPositions).on("assignSuggestions",Bi.suggest);var Fi={addon:null},Di={NONE:"none",SPINNER:"spinner",CLEAR:"clear"},Mi=function(e){var n=this,i=t('<span class="suggestions-addon"/>');n.owner=e,n.$el=i,n.type=Di.NONE,n.visible=!1,n.initialPadding=null,i.on("click",t.proxy(n,"onClick"))};Mi.prototype={checkType:function(){var e=this,n=e.owner.options.addon,i=!1;t.each(Di,function(t,e){if(i=e==n)return!1}),i||(n=e.owner.isMobile?Di.CLEAR:Di.SPINNER),n!=e.type&&(e.type=n,e.$el.attr("data-addon-type",n),e.toggle(!0))},toggle:function(t){var e,n=this;switch(n.type){case Di.CLEAR:e=!!n.owner.currentValue;break;case Di.SPINNER:e=!!n.owner.currentRequest;break;default:e=!1}e!=n.visible&&(n.visible=e,e?n.show(t):n.hide(t))},show:function(t){var e=this,n={opacity:1};t?(e.$el.show().css(n),e.showBackground(!0)):e.$el.stop(!0,!0).delay(50).queue(function(){e.$el.show(),e.showBackground(),e.$el.dequeue()}).animate(n,"fast")},hide:function(t){var e=this,n={opacity:0};t&&e.$el.hide().css(n),e.$el.stop(!0).animate(n,{duration:"fast",complete:function(){e.$el.hide(),e.hideBackground()}})},fixPosition:function(t,e){var n=this,i=e.innerHeight;n.checkType(),n.$el.css({left:t.left+e.borderLeft+e.innerWidth-i+"px",top:t.top+e.borderTop+"px",height:i,width:i}),n.initialPadding=e.paddingRight,n.width=i,n.visible&&(e.componentsRight+=i)},showBackground:function(t){var e=this,n=e.owner.el,i={paddingRight:e.width};e.width>e.initialPadding&&(e.stopBackground(),t?n.css(i):n.animate(i,{duration:"fast",queue:"addon"}).dequeue("addon"))},hideBackground:function(t){var e=this,n=e.owner.el,i={paddingRight:e.initialPadding};e.width>e.initialPadding&&(e.stopBackground(!0),t?n.css(i):n.delay(1e3,"addon").animate(i,{duration:"fast",queue:"addon"}).dequeue("addon"))},stopBackground:function(t){this.owner.el.stop("addon",!0,t)},onClick:function(t){var e=this;e.type==Di.CLEAR&&e.owner.clear()}};var Ai={createAddon:function(){var t=this,e=new Mi(t);t.$wrapper.append(e.$el),t.addon=e},fixAddonPosition:function(t,e){this.addon.fixPosition(t,e)},checkAddonType:function(){this.addon.checkType()},checkAddonVisibility:function(){this.addon.toggle()},stopBackground:function(){this.addon.stopBackground()}};t.extend(en,Fi),un.on("initialize",Ai.createAddon).on("setOptions",Ai.checkAddonType).on("fixPosition",Ai.fixAddonPosition).on("clear",Ai.checkAddonVisibility).on("valueChange",Ai.checkAddonVisibility).on("request",Ai.checkAddonVisibility).on("resetPosition",Ai.stopBackground);var $i={constraints:null,restrict_value:!1},qi=["region_fias_id","area_fias_id","city_fias_id","city_district_fias_id","settlement_fias_id","street_fias_id"],Ni=function(e,n){var i,o,r=this,s={};r.instance=n,r.fields={},r.specificity=-1,t.isPlainObject(e)&&n.type.dataComponents&&t.each(n.type.dataComponents,function(t,n){var i=n.id;n.forLocations&&e[i]&&(r.fields[i]=e[i],r.specificity=t)}),i=Ze.objectKeys(r.fields),o=Ze.arraysIntersection(i,qi),o.length?(t.each(o,function(t,e){s[e]=r.fields[e]}),r.fields=s,r.specificity=r.getFiasSpecificity(o)):r.fields.kladr_id&&(r.fields={kladr_id:r.fields.kladr_id},r.specificity=r.getKladrSpecificity(r.fields.kladr_id))};t.extend(Ni.prototype,{getLabel:function(){return this.instance.type.composeValue(this.fields,{saveCityDistrict:!0})},getFields:function(){return this.fields},isValid:function(){return!t.isEmptyObject(this.fields)},getKladrSpecificity:function(e){var n,i=-1;return this.significantKladr=e.replace(/^(\d{2})(\d*?)(0+)$/g,"$1$2"),
n=this.significantKladr.length,t.each(this.instance.type.dataComponents,function(t,e){e.kladrFormat&&n===e.kladrFormat.digits&&(i=t)}),i},getFiasSpecificity:function(e){var n=-1;return t.each(this.instance.type.dataComponents,function(i,o){o.fiasType&&t.inArray(o.fiasType,e)>-1&&n<i&&(n=i)}),n},containsData:function(e){var n=!0;return this.fields.kladr_id?!!e.kladr_id&&0===e.kladr_id.indexOf(this.significantKladr):(t.each(this.fields,function(t,i){return n=!!e[t]&&e[t].toLowerCase()===i.toLowerCase()}),n)}}),s.ConstraintLocation=Ni;var Wi=function(e,n){this.id=Ze.uniqueId("c"),this.deletable=!!e.deletable,this.instance=n,this.locations=t.map(t.makeArray(e&&(e.locations||e.restrictions)),function(t){return new Ni(t,n)}),this.locations=t.grep(this.locations,function(t){return t.isValid()}),this.label=e.label,null==this.label&&n.type.composeValue&&(this.label=t.map(this.locations,function(t){return t.getLabel()}).join(", ")),this.label&&this.isValid()&&(this.$el=t(document.createElement("li")).append(t(document.createElement("span")).text(this.label)).attr("data-constraint-id",this.id),this.deletable&&this.$el.append(t(document.createElement("span")).addClass(n.classes.removeConstraint)))};t.extend(Wi.prototype,{isValid:function(){return this.locations.length>0},getFields:function(){return t.map(this.locations,function(t){return t.getFields()})}});var zi={createConstraints:function(){var e=this;e.constraints={},e.$constraints=t('<ul class="suggestions-constraints"/>'),e.$wrapper.append(e.$constraints),e.$constraints.on("click","."+e.classes.removeConstraint,t.proxy(e.onConstraintRemoveClick,e))},setConstraintsPosition:function(t,e){var n=this;n.$constraints.css({left:t.left+e.borderLeft+e.paddingLeft+"px",top:t.top+e.borderTop+Math.round((e.innerHeight-n.$constraints.height())/2)+"px"}),e.componentsLeft+=n.$constraints.outerWidth(!0)+e.paddingLeft},onConstraintRemoveClick:function(e){var n=this,i=t(e.target).closest("li"),o=i.attr("data-constraint-id");delete n.constraints[o],n.update(),i.fadeOut("fast",function(){n.removeConstraint(o)})},setupConstraints:function(){var e,n=this,i=n.options.constraints;if(!i)return void n.unbindFromParent();i instanceof t||"string"==typeof i||"number"==typeof i.nodeType?(e=t(i),e.is(n.constraints)||(n.unbindFromParent(),e.is(n.el)||(n.constraints=e,n.bindToParent()))):(n._constraintsUpdating=!0,t.each(n.constraints,t.proxy(n.removeConstraint,n)),t.each(t.makeArray(i),function(t,e){n.addConstraint(e)}),n._constraintsUpdating=!1,n.fixPosition())},filteredLocation:function(e){var n=[],i={};if(t.each(this.type.dataComponents,function(){this.forLocations&&n.push(this.id)}),t.isPlainObject(e)&&t.each(e,function(t,e){e&&n.indexOf(t)>=0&&(i[t]=e)}),!t.isEmptyObject(i))return i.kladr_id?{kladr_id:i.kladr_id}:i},addConstraint:function(t){var e=this;t=new Wi(t,e),t.isValid()&&(e.constraints[t.id]=t,t.$el&&(e.$constraints.append(t.$el),e._constraintsUpdating||e.fixPosition()))},removeConstraint:function(t){var e=this;delete e.constraints[t],e.$constraints.children('[data-constraint-id="'+t+'"]').remove(),e._constraintsUpdating||e.fixPosition()},constructConstraintsParams:function(){for(var e,n,i=this,o=[],r=i.constraints,s={};r instanceof t&&(e=r.suggestions())&&!(n=Ze.getDeepValue(e,"selection.data"));)r=e.constraints;return r instanceof t?(n=new Ni(n,e).getFields())&&(s.locations=[n],s.restrict_value=!0):r&&(t.each(r,function(t,e){o=o.concat(e.getFields())}),o.length&&(s.locations=o,s.restrict_value=i.options.restrict_value)),s},getFirstConstraintLabel:function(){var e=this,n=t.isPlainObject(e.constraints)&&ct(e.constraints)[0];return n?e.constraints[n].label:""},bindToParent:function(){var e=this;e.constraints.on(["suggestions-select."+e.uniqueId,"suggestions-invalidateselection."+e.uniqueId,"suggestions-clear."+e.uniqueId].join(" "),t.proxy(e.onParentSelectionChanged,e)).on("suggestions-dispose."+e.uniqueId,t.proxy(e.onParentDispose,e))},unbindFromParent:function(){var e=this,n=e.constraints;n instanceof t&&n.off("."+e.uniqueId)},onParentSelectionChanged:function(t,e,n){("suggestions-select"!==t.type||n)&&this.clear()},onParentDispose:function(t){this.unbindFromParent()},getParentInstance:function(){return this.constraints instanceof t&&this.constraints.suggestions()},shareWithParent:function(t){var e=this.getParentInstance();e&&e.type===this.type&&!f(t,e)&&(e.shareWithParent(t),e.setSuggestion(t))},getUnrestrictedData:function(e){var n=this,i=[],o={},r=-1;return t.each(n.constraints,function(n,i){t.each(i.locations,function(t,n){n.containsData(e)&&n.specificity>r&&(r=n.specificity)})}),r>=0?(e.region_kladr_id&&e.region_kladr_id===e.city_kladr_id&&i.push.apply(i,n.type.dataComponentsById.city.fields),t.each(n.type.dataComponents.slice(0,r+1),function(t,e){i.push.apply(i,e.fields)}),t.each(e,function(t,e){-1===i.indexOf(t)&&(o[t]=e)})):o=e,o}};t.extend(en,$i),t.extend(s.prototype,zi),"GET"!=Ze.getDefaultType()&&un.on("initialize",zi.createConstraints).on("setOptions",zi.setupConstraints).on("fixPosition",zi.setConstraintsPosition).on("requestParams",zi.constructConstraintsParams).on("dispose",zi.unbindFromParent);var Ui={proceedQuery:function(t){var e=this;t.length>=e.options.minChars?e.updateSuggestions(t):e.hide()},selectCurrentValue:function(e){var n=this,i=t.Deferred();return n.inputPhaseResolve(),n.fetchPhase.done(function(){var t;n.selection&&!n.visible?i.reject():(t=n.findSuggestionIndex(),n.select(t,e),-1===t?i.reject():i.resolve(t))}).fail(function(){i.reject()}),i},selectFoundSuggestion:function(){var t=this;t.requestMode.userSelect||t.select(0)},findSuggestionIndex:function(){var e,n=this,i=n.selectedIndex;return-1===i&&(e=t.trim(n.el.val()))&&t.each(n.type.matchers,function(t,o){return-1===(i=o(e,n.suggestions))}),i},select:function(e,n){var i,o=this,r=o.suggestions[e],s=n&&n.continueSelecting,a=o.currentValue;if(!o.triggering.Select){if(!r)return s||o.selection||o.triggerOnSelectNothing(),void o.onSelectComplete(s);i=o.hasSameValues(r),o.enrichSuggestion(r,n).done(function(r,s){o.selectSuggestion(r,e,a,t.extend({hasBeenEnriched:s,hasSameValues:i},n))})}},selectSuggestion:function(t,e,n,i){var o=this,r=i.continueSelecting,s=!o.type.isDataComplete||o.type.isDataComplete.call(o,t),a=o.selection;o.triggering.Select||(o.type.alwaysContinueSelecting&&(r=!0),s&&(r=!1),i.hasBeenEnriched&&o.suggestions[e]&&(o.suggestions[e].data=t.data),o.requestMode.updateValue&&(o.checkValueBounds(t),o.currentValue=o.getSuggestionValue(t,i),!o.currentValue||i.noSpace||s||(o.currentValue+=" "),o.el.val(o.currentValue)),o.currentValue?(o.selection=t,o.areSuggestionsSame(t,a)||o.trigger("Select",t,o.currentValue!=n),o.requestMode.userSelect&&o.onSelectComplete(r)):(o.selection=null,o.triggerOnSelectNothing()),o.shareWithParent(t))},onSelectComplete:function(t){var e=this;t?(e.selectedIndex=-1,e.updateSuggestions(e.currentValue)):e.hide()},triggerOnSelectNothing:function(){var t=this;t.triggering.SelectNothing||t.trigger("SelectNothing",t.currentValue)},trigger:function(e){var n=this,i=Ze.slice(arguments,1),o=n.options["on"+e];n.triggering[e]=!0,t.isFunction(o)&&o.apply(n.element,i),n.el.trigger.call(n.el,"suggestions-"+e.toLowerCase(),i),n.triggering[e]=!1}};t.extend(s.prototype,Ui),un.on("assignSuggestions",Ui.selectFoundSuggestion);var Hi={bounds:null},Ki={setupBounds:function(){this.bounds={from:null,to:null}},setBoundsOptions:function(){var e,n,i=this,o=[],r=t.trim(i.options.bounds).split("-"),s=r[0],a=r[r.length-1],u=[],c=[];i.type.dataComponents&&t.each(i.type.dataComponents,function(){this.forBounds&&o.push(this.id)}),-1===t.inArray(s,o)&&(s=null),n=t.inArray(a,o),-1!==n&&n!==o.length-1||(a=null),(s||a)&&(e=!s,t.each(o,function(t,n){if(n==s&&(e=!0),c.push(n),e&&u.push(n),n==a)return!1})),i.bounds.from=s,i.bounds.to=a,i.bounds.all=c,i.bounds.own=u},constructBoundsParams:function(){var t=this,e={};return t.bounds.from&&(e.from_bound={value:t.bounds.from}),t.bounds.to&&(e.to_bound={value:t.bounds.to}),e},checkValueBounds:function(t){var e,n=this;if(n.bounds.own.length&&n.type.composeValue){var i=n.bounds.own.slice(0);1===i.length&&"city_district"===i[0]&&i.push("city_district_fias_id"),e=n.copyDataComponents(t.data,i),t.value=n.type.composeValue(e)}},copyDataComponents:function(e,n){var i={},o=this.type.dataComponentsById;return o&&t.each(n,function(n,r){t.each(o[r].fields,function(t,n){null!=e[n]&&(i[n]=e[n])})}),i},getBoundedKladrId:function(e,n){var i,o=n[n.length-1];return t.each(this.type.dataComponents,function(t,e){if(e.id===o)return i=e.kladrFormat,!1}),e.substr(0,i.digits)+new Array((i.zeros||0)+1).join("0")}};t.extend(en,Hi),t.extend(s.prototype,Ki),un.on("initialize",Ki.setupBounds).on("setOptions",Ki.setBoundsOptions).on("requestParams",Ki.constructBoundsParams),s.defaultOptions=en,s.version="99.9.9",t.Suggestions=s,t.fn.suggestions=function(e,n){return 0===arguments.length?this.first().data("suggestions"):this.each(function(){var i=t(this),o=i.data("suggestions");"string"==typeof e?o&&"function"==typeof o[e]&&o[e](n):(o&&o.dispose&&o.dispose(),o=new s(this,e),i.data("suggestions",o))})}});